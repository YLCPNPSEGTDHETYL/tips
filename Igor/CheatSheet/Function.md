
### Functionで始まるプロシージャ

---

`Function`で始まるプロシージャは、特定の操作を繰り返すために使用されます。簡単な繰り返し処理を行う場合には、この構文が便利です。

- **繰り返しファンクションの例**

    ```igor
    Function myfunc()
      Variable i
      for i = 1, 10
          Print i
      end
    End
    ```

この例では、`myfunc`が実行されると、1から10までの数字が順番に出力されます。


Fuctionのフラグには、以下を指定できます。

| **フラグ** | **復帰値の型** |
| --- | --- |
| /C | 複素数 |
| /S | 文字列 |

### パラメータ宣言、ローカル宣言

---

プロシージャがパラメータ（引数）やローカル変数を使用する場合、パラメータ宣言→ローカル宣言の順に宣言を行います。

パラメータ宣言は、**必ずFunctionの最初の行に行う**必要があります。

```igor
Function Example(p1) //p1をパラメータに取る
	Variable p1 //パラメータ宣言
	
	// 以下、ローカル宣言
	Variable v1, v2
	Variable v3=0
	Variable/C cv1=cmplx(0,0)
	String s1="test", s2="test2"
	
	// ここに実行内容を書く
End
```


### コマンドラインで操作関数を打つ場合や、マクロとの違い

---

コマンドライン、ファンクション、マクロはそれぞれ得意な役割があります。

| **項目名** | **得意なこと** | **使えるコマンド例** |
| --- | --- | --- |
| **コマンドウィンドウ** | 単発の操作
簡単な処理の実行 | 操作関数（`Display`、`Print`、`Make`など） |
| **ファンクション** | ループや条件分岐のある計算 | 操作関数＋条件文、ループ文（`If-ElseIf-EndIf`、`For`、`Do-While`など） |
| **マクロ** | 定型的な処理
複数のファンクションを順に実行 | 操作関数＋条件文、ループ文 |

{ファンクションとマクロの違いの詳細は：}[modal-14]


---

- **関連リンク**

    <div class="related-link-wrapper">
      [modal-10]<!--return文--><br>
      [modal-15]<!--MacroとFunctionの違い--><br>
      [modal-16]<!--Procedureでの$の使用--><br>
      [modal-7]<!--Macroの構文-->
    </div>